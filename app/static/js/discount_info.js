(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["discount_info"],{

/***/ "../../src/mvfx_frontend/public/discount_info/discount_info.js":
/*!*************************************************************************!*\
  !*** /opt/mvfx/src/mvfx_frontend/public/discount_info/discount_info.js ***!
  \*************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.discountInfoInit = discountInfoInit;\n\nvar _jquery = __webpack_require__(/*! jquery */ \"../../../../node_modules/jquery/dist/jquery.js-exposed\");\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _helper_utils = __webpack_require__(/*! ../../shared/helper_utils/helper_utils */ \"../../src/mvfx_frontend/shared/helper_utils/helper_utils.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * DISCOUNT INFO BOX\n * =================\n * Displays discount suggestion info box when:\n * - User enters a page and discount suggestion was not previously discarded in the same browser session.\n * - User adds or removes a product from the cart and is eligable for a different discount and the discount suggestion was not previously discarded in the same browser session. \n */\n\n/* istanbul ignore next */\n(0, _jquery2.default)(document).ready(function () {\n    discountInfoInit();\n});\n\nfunction discountInfoInit() {\n\n    if ((0, _helper_utils.isTouchDevice)()) {\n        return;\n    }\n\n    var settings = (0, _jquery2.default)('#discountInfoSettings').data();\n    var user_settings = (0, _jquery2.default)('#userInfoSettings').data();\n\n    var $discountInfo = (0, _jquery2.default)('.discount-info'); // Discount info box container element.\n    var $productSetListBtn = (0, _jquery2.default)('#productSetListBtn'); // Link button that leads to list of products that belong to discount set.\n    var $bundleDiscountBtn = (0, _jquery2.default)('#bundleDiscountBtn'); // Button for check logged user discount for bundle\n    var $bundleDiscountInfo = (0, _jquery2.default)('#bundleDiscountInfo'); // Info for bundle discount\n\n    if (user_settings.isAuthenticated == 'True') {\n        localStorage.setItem('discardedNewsletter', JSON.stringify({ 'status': 'hidden' }));\n    }\n\n    if (localStorage.getItem('discardedNewsletter') != null) {\n        for (var i = 0; i < settings.initCartState.suggestions.length; i++) {\n            if (settings.initCartState.suggestions[i].newsletter_sign_up) {\n                settings.initCartState.suggestions.shift();\n                break;\n            }\n        }\n    }\n\n    var currentDiscountInfo = settings.initCartState.suggestions[0] || {}; // Currently active discount suggestion data.\n\n    var discardedDiscounts = { quantity: [], product_set: [], promo_code: [] }; // Discount suggestions dismissed by the user seperated into two types.\n\n    // Render discount suggestions every time the cart state is changed (ex. user could add or remove a product from minicart).\n    (0, _jquery2.default)(document).on('mvfx:cartRefreshed', function (e) {\n        currentDiscountInfo = e.cartState.suggestions[0] || {};\n        renderDiscountInfo(currentDiscountInfo);\n    });\n\n    $discountInfo.find('.dismiss-btn').on('click', function () {\n        markAsDiscarded(currentDiscountInfo);\n        hideDiscountInfo();\n    });\n\n    $productSetListBtn.on('click', function (e) {\n        e.preventDefault();\n        markAsDiscarded(currentDiscountInfo);\n        window.location.href = currentDiscountInfo.more_link;\n    });\n\n    // Check for already discarded discount suggestions.\n    if (sessionStorage.getItem('discardedDiscounts')) {\n        discardedDiscounts = JSON.parse(sessionStorage.getItem('discardedDiscounts'));\n    } else {\n        sessionStorage.setItem('discardedDiscounts', JSON.stringify(discardedDiscounts));\n    }\n\n    setTimeout(function () {\n        return renderDiscountInfo(currentDiscountInfo);\n    }, settings.showDelay); // Delay initial discount info showing a bit.\n\n    /**\n     * Hides discount info box and product set list link (in case the next suggestion is of quantity type).\n     */\n    function hideDiscountInfo() {\n        $discountInfo.addClass('hide-discount-info');\n        setTimeout(function () {\n            return $productSetListBtn.addClass('d-none');\n        }, settings.showDelay); // Delay button hide till animation finishes.\n    }\n\n    /**\n     * Save discarded discount suggestion into session storage.\n     * @param {object} discountInfo \n     * @param {integer} discountInfo.id     \n     * @param {string} discount.type - Either 'quantity', 'product_set' or 'promo_code'.     \n     */\n    function markAsDiscarded(discountInfo) {\n        discardedDiscounts[currentDiscountInfo.type].push(discountInfo.id);\n        sessionStorage.setItem('discardedDiscounts', JSON.stringify(discardedDiscounts));\n    }\n\n    /**\n     * Renders contents and displays discount info box.\n     * @param {object} discountInfo \n     * @param {integer} discountInfo.id\n     * @param {string} discount.suggestion_title\n     * @param {string} discount.suggestion_msg\n     * @param {string} discount.type - Either 'quantity', 'product_set' or 'promo_code'.     \n     */\n    function renderDiscountInfo() {\n        var discountInfo = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n\n        // Hide discount box and do nothing when no discount suggestion is available or suggestion was already dismissed.\n        if (!discountInfo.id || !discardedDiscounts[discountInfo.type] || discardedDiscounts[discountInfo.type].includes(discountInfo.id)) {\n            return hideDiscountInfo();\n        }\n\n        var title = discountInfo.suggestion_title;\n        var valuePosition = title.search(/\\d/); // Determine the position of discount percent value.\n        var titleHtml = title.substr(0, valuePosition) + ' <b> ' + title.substr(valuePosition) + '</b>'; // Put emphasis on the discount.\n\n        (0, _jquery2.default)('.discount-title').html(titleHtml);\n        (0, _jquery2.default)('.discount-msg').html(discountInfo.suggestion_msg);\n\n        if (discountInfo.type === 'product_set') {\n            $productSetListBtn.removeClass('d-none');\n        } else {\n            $productSetListBtn.addClass('d-none');\n        }\n\n        $discountInfo.removeClass('hide-discount-info');\n    }\n}\n\n//# sourceURL=webpack:////opt/mvfx/src/mvfx_frontend/public/discount_info/discount_info.js?");

/***/ }),

/***/ "../../src/mvfx_frontend/public/discount_info/index.js":
/*!*****************************************************************!*\
  !*** /opt/mvfx/src/mvfx_frontend/public/discount_info/index.js ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n__webpack_require__(/*! ./discount_info */ \"../../src/mvfx_frontend/public/discount_info/discount_info.js\");\n\n//# sourceURL=webpack:////opt/mvfx/src/mvfx_frontend/public/discount_info/index.js?");

/***/ })

},[["../../src/mvfx_frontend/public/discount_info/index.js","runtime","commons"]]]);